{%- comment -%}
  SECTION: Marquee USP

  This section creates a scrolling marquee of icons and text.
  - Supports a main heading.
  - Uses blocks for each item in the marquee.
  - Each block has an icon and a title.
  - Includes a color scheme setting.
{%- endcomment -%}

<div class="marquee-usp-section color-{{ section.settings.color_scheme }}">
  <div class="page-width">
    {%- if section.settings.heading != blank -%}
      <h2 class="marquee-usp__heading">{{ section.settings.heading | escape }}</h2>
    {%- endif -%}
  </div>

  <div class="marquee-usp__wrapper">
    <div class="marquee-usp__content">
      {%- for block in section.blocks -%}
        <div class="marquee-usp__item" {{ block.shopify_attributes }}>
          <div class="marquee-usp__icon">
            {%- if block.settings.icon != blank -%}
              <img
                src="{{ block.settings.icon | image_url: width: 100 }}"
                alt="{{ block.settings.icon.alt | default: block.settings.title }}"
                width="50"
                height="{{ 50 | divided_by: block.settings.icon.aspect_ratio | round }}"
                loading="lazy"
              >
            {%- else -%}
              {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
            {%- endif -%}
          </div>
          <div class="marquee-usp__title">
            <p>{{ block.settings.title | escape }}</p>
          </div>
        </div>
      {%- endfor -%}
    </div>
    <!-- The content is duplicated to create a seamless loop -->
    <div class="marquee-usp__content" aria-hidden="true">
       {%- for block in section.blocks -%}
        <div class="marquee-usp__item">
          <div class="marquee-usp__icon">
            {%- if block.settings.icon != blank -%}
              <img
                src="{{ block.settings.icon | image_url: width: 100 }}"
                alt="{{ block.settings.icon.alt | default: block.settings.title }}"
                width="50"
                height="{{ 50 | divided_by: block.settings.icon.aspect_ratio | round }}"
                loading="lazy"
              >
            {%- else -%}
              {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
            {%- endif -%}
          </div>
          <div class="marquee-usp__title">
            <p>{{ block.settings.title | escape }}</p>
          </div>
        </div>
      {%- endfor -%}
    </div>
  </div>
</div>

{%- style -%}
  .marquee-usp-section {
    padding: 40px 0;
    overflow: hidden; /* Hides the overflowing content */
    background-color: var(--color-background);
    color: var(--color-foreground);
  }

  .marquee-usp__heading {
    text-align: center;
    font-size: 2.5rem;
    margin-bottom: 35px !important;
  }

  .marquee-usp__wrapper {
    display: flex;
    white-space: nowrap; /* Prevents items from wrapping to the next line */
  }

  .marquee-usp__content {
    display: inline-block;
    animation: scroll 20s linear infinite;
  }

  /* Pause animation on hover for better user experience */
  .marquee-usp__wrapper:hover .marquee-usp__content {
    animation-play-state: paused;
  }

  .marquee-usp__item {
    display: inline-flex; /* Aligns icon and text */
    flex-direction: column;
    align-items: center;
    justify-content: center;
    margin: 0 40px; /* Space between items */
    text-align: center;
  }

  .marquee-usp__icon img {
    max-width: 50px;
    height: auto;
    margin-bottom: 15px;
  }

  .marquee-usp__title {
    font-size: 1.2rem;
    font-weight: 600;
  }

  /* The Keyframe animation for the scroll effect */
  @keyframes scroll {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(-100%);
    }
  }

  @media screen and (max-width: 750px) {
    .marquee-usp__heading {
      font-size: 2rem;
    }
    .marquee-usp__item {
      margin: 0 25px;
    }
  }
{%- endstyle -%}

{% schema %}
{
  "name": "Marquee USP",
  "tag": "section",
  "class": "marquee-usp-section-wrapper",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Why Choose Us"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "background-1"
    }
  ],
  "blocks": [
    {
      "type": "usp_item",
      "name": "USP Item",
      "limit": 10,
      "settings": [
        {
          "type": "image_picker",
          "id": "icon",
          "label": "Icon Image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Feature Title"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Marquee USP",
      "blocks": [
        { "type": "usp_item" },
        { "type": "usp_item" },
        { "type": "usp_item" },
        { "type": "usp_item" },
        { "type": "usp_item" }
      ]
    }
  ]
}
{% endschema %}

