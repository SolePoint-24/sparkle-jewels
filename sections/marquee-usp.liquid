{%- comment -%}
 SECTION: Marquee USP

 This section creates a scrolling marquee of icons and text.
 - Supports a main heading.
 - Uses blocks for each item in the marquee.
 - Each block has an icon and a title.
 - Includes a color scheme setting.
 - Animation speed is adjustable.
 - Duplicates content to ensure a seamless loop without gaps.
{%- endcomment -%}

<div class="marquee-usp-section color-{{ section.settings.color_scheme }}">
 <div class="page-width">
  {%- if section.settings.heading != blank -%}
   <h2 class="marquee-usp__heading">{{ section.settings.heading | escape }}</h2>
  {%- endif -%}
 </div>

 <div class="marquee-usp__wrapper">
  <div class="marquee-usp__scroller" style="animation-duration: {{ section.settings.animation_speed }}s;">
   {%- comment -%}
    The content is rendered 4 times to ensure the total width is
    always greater than the viewport, preventing any gaps in the loop.
   {%- endcomment -%}
   {%- for i in (1..4) -%}
    {%- for block in section.blocks -%}
     <div class="marquee-usp__item" {% if forloop.parentloop.first %}{{ block.shopify_attributes }}{% endif %}>
      <div class="marquee-usp__icon">
       {%- if block.settings.icon != blank -%}
        <img
         src="{{ block.settings.icon | image_url: width: 100 }}"
         alt="{{ block.settings.icon.alt | default: block.settings.title }}"
         width="50"
         height="{{ 50 | divided_by: block.settings.icon.aspect_ratio | round }}"
         loading="lazy"
        >
       {%- else -%}
        {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
       {%- endif -%}
      </div>
      <div class="marquee-usp__title">
       <p>{{ block.settings.title | escape }}</p>
      </div>
     </div>
    {%- endfor -%}
   {%- endfor -%}
  </div>
 </div>
</div>

{%- style -%}
 .marquee-usp-section {
  padding: 40px 0;
  background-color: var(--color-background);
  color: var(--color-foreground);
 }

 .marquee-usp__heading {
  text-align: center;
  font-size: 2.5rem;
  margin-bottom: 40px !important;
 }

 .marquee-usp__wrapper {
  overflow: hidden;
  display: flex;
  white-space: nowrap;
 }

 .marquee-usp__scroller {
  display: flex;
  flex-shrink: 0;
  animation: scroll-marquee linear infinite;
 }

 /* Pause animation on hover for better user experience */
 .marquee-usp__wrapper:hover .marquee-usp__scroller {
  animation-play-state: paused;
 }

 .marquee-usp__item {
  display: flex; /* Changed to flex for better alignment */
  flex-direction: column;
  align-items: center;
  justify-content: center;
  margin: 0 40px; /* Space between items */
  text-align: center;
 }

 .marquee-usp__icon img {
  max-width: 50px;
  height: auto;
  margin-bottom: 15px;
 }

 .marquee-usp__title {
  font-size: 1.2rem;
  font-weight: 600;
 }

 /* The Keyframe animation for the scroll effect */
 @keyframes scroll-marquee {
  from {
   transform: translateX(0);
  }
  to {
   /* This translates the content by one-quarter of its total width, creating a perfect loop */
   transform: translateX(-25%);
  }
 }

 @media screen and (max-width: 750px) {
  .marquee-usp__heading {
   font-size: 2rem;
  }
  .marquee-usp__item {
   margin: 0 25px;
  }
 }
{%- endstyle -%}

{% schema %}
{
 "name": "Marquee USP",
 "tag": "section",
 "class": "marquee-usp-section-wrapper",
 "settings": [
  {
   "type": "text",
   "id": "heading",
   "label": "Heading",
   "default": "Why Choose Us"
  },
  {
   "type": "color_scheme",
   "id": "color_scheme",
   "label": "Color scheme",
   "default": "background-1"
  },
  {
   "type": "range",
   "id": "animation_speed",
   "min": 10,
   "max": 100,
   "step": 5,
   "unit": "s",
   "label": "Animation speed",
   "info": "Slower speed is a higher number.",
   "default": 30
  }
 ],
 "blocks": [
  {
   "type": "usp_item",
   "name": "USP Item",
   "limit": 10,
   "settings": [
    {
     "type": "image_picker",
     "id": "icon",
     "label": "Icon Image"
    },
    {
     "type": "text",
     "id": "title",
     "label": "Title",
     "default": "Feature Title"
    }
   ]
  }
 ],
 "presets": [
  {
   "name": "Marquee USP",
   "blocks": [
    { "type": "usp_item" },
    { "type": "usp_item" },
    { "type": "usp_item" },
    { "type": "usp_item" },
    { "type": "usp_item" }
   ]
  }
 ]
}
{% endschema %}
